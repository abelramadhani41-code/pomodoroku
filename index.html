<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå∏ Aesthetic Pomodoro Focus Room üå∏</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚è∞</text></svg>">
    <style>
        :root{--p:#84a98c;--t:#333d47;--bg:rgba(255,255,255,0.95);--panel:rgba(255,255,255,0.7);--sh:rgba(0,0,0,0.15);--c-theme:var(--p);--c-text:#333d47}
        body.dark-mode{--t:#e0e0e0;--bg:rgba(30,30,30,0.95);--panel:rgba(40,40,40,0.8);--sh:rgba(255,255,255,0.1)}
        body.dark-mode .menu-option h3,body.dark-mode .theme-item,body.dark-mode .music-item span{color:#fff!important}
        *{margin:0;padding:0;box-sizing:border-box}
        *::-webkit-scrollbar{width:10px}*::-webkit-scrollbar-thumb{background:var(--c-theme);border-radius:5px}
        body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;color:var(--t);display:flex;justify-content:center;align-items:center;min-height:100vh;overflow:hidden}
        @keyframes z{0%{transform:scale(0.5);opacity:0}50%{transform:scale(1.1)}100%{transform:scale(1);opacity:1}}
        @keyframes u{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
        @keyframes f{0%,100%{transform:translateY(0) rotate(0deg)}50%{transform:translateY(-20px) rotate(5deg)}}
        @keyframes b{0%,100%{transform:translateY(0)}50%{transform:translateY(-15px)}}
        @keyframes g{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
        @keyframes p{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        .splash-screen{position:fixed;inset:0;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:1000;background:linear-gradient(-45deg,#E0BBE4,#957DAD,#D291BC,#FEC8D8,#FFDFD3);background-size:400% 400%;animation:g 15s ease infinite;color:#fff;text-align:center;transition:opacity 1s}
        .splash-screen.hidden{opacity:0;visibility:hidden;pointer-events:none}
        .splash-logo{font-size:8em;font-weight:900;text-shadow:0 10px 30px rgba(0,0,0,0.5);animation:z 2s ease-out}
        .splash-subtitle{font-size:2.5em;font-weight:700;margin:.5em 0;animation:u 1.5s ease-out .5s both}
        .splash-characters{display:flex;gap:50px;margin:30px 0;animation:u 1.8s ease-out .8s both}
        .character{font-size:8em;animation:b 2s ease-in-out infinite}.character:nth-child(2){animation-delay:.3s}
        .start-button{padding:20px 60px;font-size:1.8em;font-weight:800;border:none;border-radius:50px;background:linear-gradient(135deg,#fff,#f5f5f5);color:#957DAD;cursor:pointer;box-shadow:0 10px 40px rgba(0,0,0,0.4);animation:u 2s ease-out 1.2s both,p 2s infinite 3s;text-transform:uppercase}
        .start-button:hover{transform:translateY(-8px) scale(1.05)}
        .floating-icons{position:absolute;width:100%;height:100%;overflow:hidden;pointer-events:none}
        .floating-icon{position:absolute;font-size:3em;opacity:.6}
        .floating-icon:nth-child(1){top:10%;left:10%;animation:f 6s ease-in-out infinite}
        .floating-icon:nth-child(2){top:20%;right:15%;animation:f 7s ease-in-out infinite 1s}
        .floating-icon:nth-child(3){bottom:15%;left:20%;animation:f 8s ease-in-out infinite 2s}
        .floating-icon:nth-child(4){bottom:20%;right:10%;animation:f 6.5s ease-in-out infinite .5s}
        .floating-icon:nth-child(5){top:50%;left:5%;animation:f 5s ease-in-out infinite}
        .floating-icon:nth-child(6){top:60%;right:8%;animation:b 3s ease-in-out infinite 1s}
        .bg-overlay{position:fixed;inset:0;z-index:-1;background:linear-gradient(135deg,#a8dadc,#457b9d,#1d3557);transition:all .8s ease}
        .bg-elements{position:absolute;width:100%;height:100%;opacity:.3}
        .bg-el{position:absolute;font-size:2em;animation:f 10s ease-in-out infinite}
        .main-view{position:fixed;inset:0;display:flex;justify-content:center;align-items:center;z-index:10}
        .container{background:var(--bg);backdrop-filter:blur(10px);padding:50px;border-radius:25px;box-shadow:0 15px 40px var(--sh);text-align:center;width:90%;max-width:600px}
        h1{font-weight:700;color:var(--c-text);margin-bottom:30px;font-size:2.5em}
        .three-dots-menu{position:fixed;top:20px;right:20px;z-index:100;cursor:pointer}
        .dots-icon{background:var(--bg);border:2px solid var(--c-theme);border-radius:50%;width:50px;height:50px;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:4px;box-shadow:0 4px 15px var(--sh);transition:all .3s}
        .dots-icon:hover{transform:scale(1.1)}.dot{width:6px;height:6px;background:var(--c-theme);border-radius:50%}
        .menu-dropdown{position:absolute;top:60px;right:0;background:var(--bg);border-radius:15px;box-shadow:0 10px 30px var(--sh);padding:10px;min-width:200px;opacity:0;visibility:hidden;transform:translateY(-10px);transition:all .3s}
        .menu-dropdown.active{opacity:1;visibility:visible;transform:translateY(0)}
        .menu-option{padding:15px 20px;cursor:pointer;border-radius:10px;transition:all .2s;display:flex;align-items:center;gap:10px;color:var(--t)}
        .menu-option:hover{background:var(--c-theme);color:#fff!important;transform:translateX(5px)}
        .fullscreen-view{position:fixed;inset:0;background:var(--bg);z-index:500;display:none;overflow-y:auto;padding:80px 40px 40px}
        .fullscreen-view.active{display:block}
        .back-button{position:fixed;top:20px;left:20px;padding:12px 25px;background:var(--c-theme);color:#fff!important;border:none;border-radius:50px;cursor:pointer;font-weight:700;font-size:1.1em;box-shadow:0 4px 15px var(--sh);z-index:510;transition:all .3s}
        .back-button:hover{transform:translateY(-3px)}
        .home-button{position:fixed;top:20px;left:20px;padding:12px 25px;background:var(--c-theme);color:#fff!important;border:none;border-radius:50px;cursor:pointer;font-weight:700;font-size:1.1em;box-shadow:0 4px 15px var(--sh);z-index:100;transition:all .3s;display:flex;align-items:center;gap:8px}
        .home-button:hover{transform:translateY(-3px) scale(1.05)}
        .view-title{text-align:center;font-size:3em;font-weight:800;color:var(--c-theme);margin-bottom:40px}
        .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:30px;max-width:1200px;margin:0 auto}
        .card{background:var(--panel);border:2px solid transparent;border-radius:20px;padding:30px;cursor:pointer;transition:all .3s;text-align:center}
        .card:hover{transform:translateY(-10px);box-shadow:0 15px 40px var(--sh)}
        .card.active{border-color:var(--c-theme);background:var(--c-theme);color:#fff!important}
        .music-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
        .music-btn{background:var(--c-theme);color:#fff!important;border:none;border-radius:50%;width:45px;height:45px;cursor:pointer;font-size:1.2em;display:flex;align-items:center;justify-content:center;transition:all .3s}
        .music-btn:hover{transform:scale(1.1)}
        .quiz-modal{position:fixed;inset:0;background:rgba(0,0,0,0.9);display:none;justify-content:center;align-items:center;z-index:1000;padding:20px}
        .quiz-modal.active{display:flex}
        .quiz-content{background:var(--bg);padding:50px;border-radius:25px;max-width:900px;width:100%;max-height:90vh;overflow-y:auto}
        .quiz-header{display:flex;justify-content:space-between;margin-bottom:30px;font-weight:700;color:var(--c-theme);font-size:1.2em}
        .quiz-question{font-size:1.8em;font-weight:700;margin-bottom:30px;color:var(--t);line-height:1.4}
        .quiz-option{padding:20px 25px;border:3px solid var(--c-theme);border-radius:15px;background:var(--panel);cursor:pointer;transition:all .3s;text-align:left;font-size:1.1em;margin-bottom:15px}
        .quiz-option:hover{background:var(--c-theme);color:#fff!important;transform:translateX(10px)}
        .quiz-option.correct{background:#2ecc71!important;color:#fff!important;border-color:#2ecc71}
        .quiz-option.incorrect{background:#e74c3c!important;color:#fff!important;border-color:#e74c3c}
        .quiz-option.disabled{pointer-events:none;opacity:.6}
        .quiz-explanation{background:var(--panel);padding:25px;border-radius:15px;margin:20px 0;border-left:5px solid var(--c-theme)}
        .quiz-nav-btn{padding:15px 40px;background:var(--c-theme);color:#fff!important;border:none;border-radius:50px;cursor:pointer;font-weight:700;font-size:1.1em;margin:10px;transition:all .3s}
        .modes{margin-bottom:30px;background:rgba(0,0,0,0.1);padding:8px;border-radius:15px;display:flex;gap:5px;transition:all .3s}
        body.dark-mode .modes{background:rgba(255,255,255,0.1)}
        .modes button{flex:1;padding:12px 15px;border:none;border-radius:12px;background:0 0;font-weight:600;cursor:pointer;color:var(--t);transition:all .2s}
        .modes button.active{background:var(--c-theme);color:#fff!important;box-shadow:0 4px 10px rgba(0,0,0,0.1)}
        .progress-circle{position:relative;width:320px;height:320px;margin:30px auto;display:flex;justify-content:center;align-items:center}
        .timer-display{position:absolute;font-size:5em;font-weight:900;color:var(--c-text);z-index:10;transition:color .3s}
        .motivational-quote{position:absolute;top:20px;left:50%;transform:translateX(-50%);background:var(--bg);border:2px solid var(--c-theme);padding:15px 30px;border-radius:20px;font-size:1.1em;font-style:italic;color:var(--t);max-width:600px;box-shadow:0 4px 15px var(--sh);text-align:center;z-index:5;transition:all .3s}
        .progress-ring{position:absolute;transform:rotate(-90deg)}
        .progress-ring__circle{transition:stroke-dashoffset 1s linear}
        .progress-ring__bg{stroke:rgba(0,0,0,0.1)}
        body.dark-mode .progress-ring__bg{stroke:rgba(255,255,255,0.1)}
        .progress-ring__active{stroke:var(--c-theme);opacity:.9;transition:stroke-dashoffset 1s linear, stroke 0.3s ease}
        .controls{margin-top:30px;display:flex;gap:15px;justify-content:center;flex-wrap:wrap}
        .controls button{padding:15px 35px;border:none;border-radius:50px;font-size:1.2em;font-weight:700;cursor:pointer;background:var(--c-theme);color:#fff!important;box-shadow:0 4px 12px rgba(0,0,0,0.1);transition:all .3s}
        .controls button:hover{transform:translateY(-3px)}
        .dark-mode-toggle{position:fixed;bottom:20px;right:20px;z-index:100;display:flex;align-items:center;gap:10px;background:var(--bg);padding:10px 20px;border-radius:50px;box-shadow:0 4px 15px var(--sh);transition:all .3s}
        .toggle-switch{width:60px;height:30px;background:#ccc;border-radius:15px;position:relative;cursor:pointer;transition:background .3s}
        .toggle-switch.active{background:var(--c-theme)}
        .toggle-slider{width:26px;height:26px;background:#fff;border-radius:50%;position:absolute;top:2px;left:2px;transition:transform .3s}
        .toggle-switch.active .toggle-slider{transform:translateX(30px)}
        .daily-progress-circle{position:relative;width:200px;height:200px;margin:20px auto}
        .daily-progress-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:2em;font-weight:700;color:var(--c-theme);transition:color .3s}
        .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-top:30px}
        .stat-item{background:var(--panel);padding:25px;border-radius:15px;text-align:center;box-shadow:0 2px 10px var(--sh);transition:all .3s}
        .stat-item-value{font-size:2.5em;font-weight:900;color:var(--c-theme);transition:color .3s}
        #daily-target-input{padding:5px;border-radius:5px;border:2px solid var(--c-theme);width:80px;text-align:center;background:transparent;color:var(--t)}
        @media(max-width:768px){.container{padding:30px 20px}.timer-display{font-size:3.5em}.view-title{font-size:2em}.splash-logo{font-size:4em}.character{font-size:5em}.motivational-quote{max-width:90%;padding:10px 20px;font-size:1em}.stats-grid{grid-template-columns:1fr 1fr}.home-button{padding:10px 20px;font-size:1em}}
    </style>
</head>
<body>
    <div class="splash-screen" id="splash-screen">
        <div class="floating-icons"><div class="floating-icon">üìö</div><div class="floating-icon">‚ú®</div><div class="floating-icon">üéØ</div><div class="floating-icon">üí°</div><div class="floating-icon">‚è∞</div><div class="floating-icon">üåü</div></div>
        <div class="splash-logo">FOCUS ROOM</div>
        <div class="splash-subtitle">üå∏ Pomodoro Study Timer üå∏</div>
        <div class="splash-characters"><div class="character">üë®‚Äçüéì</div><div class="character">üë©‚Äçüéì</div></div>
        <button class="start-button" id="start-focus-btn">üöÄ Mulai Belajar</button>
    </div>

    <div class="bg-overlay" id="background-overlay"><div class="bg-elements" id="bg-elements"></div></div>
    
    <button class="home-button" id="home-button" style="display:none" onclick="goToHome()">üè† Home</button>
    
    <div class="three-dots-menu">
        <div class="dots-icon" id="dots-icon"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
        <div class="menu-dropdown" id="menu-dropdown">
            <div class="menu-option" data-view="theme"><span>üé®</span><span>Tema</span></div>
            <div class="menu-option" data-view="music"><span>üéµ</span><span>Musik</span></div>
            <div class="menu-option" data-view="quiz"><span>üß©</span><span>Tebak-Tebakan</span></div>
            <div class="menu-option" data-view="stats"><span>üìä</span><span>Statistik</span></div>
        </div>
    </div>
    
    <div class="dark-mode-toggle">
        <span class="mode-label" id="mode-label">Light Mode</span>
        <div class="toggle-switch" id="dark-mode-toggle"><div class="toggle-slider"></div></div>
    </div>

    <div class="main-view" id="main-view">
        <div class="motivational-quote" id="quote-display">"Tekad hari ini menentukan kesuksesan hari esok."</div>
        <div class="container">
            <h1>‚è∞ Pomodoro Timer</h1>
            <div class="modes"><button id="focus-btn" class="active">Fokus (25m)</button><button id="shortBreak-btn">Istirahat (5m)</button><button id="longBreak-btn">Lama (15m)</button></div>
            <div class="progress-circle">
                <div class="timer-display"><span id="minutes">25</span>:<span id="seconds">00</span></div>
                <svg class="progress-ring" width="320" height="320"><circle class="progress-ring__circle progress-ring__bg" stroke-width="12" fill="transparent" r="154" cx="160" cy="160"/><circle class="progress-ring__circle progress-ring__active" stroke-width="12" fill="transparent" r="154" cx="160" cy="160"/></svg>
            </div>
            <div class="controls"><button id="start-pause-btn">‚ñ∂Ô∏è Mulai</button><button id="reset-btn">üîÑ Reset</button></div>
            <p class="status-message" id="status-msg">Waktunya untuk fokus dan belajar! ‚ú®</p>
        </div>
    </div>
    
    <div class="fullscreen-view" id="theme-view"><button class="back-button" onclick="closeView('theme-view')">‚Üê Kembali</button><h2 class="view-title">üé® Pilih Tema</h2><div class="grid" id="theme-grid"></div></div>
    
    <div class="fullscreen-view" id="music-view"><button class="back-button" onclick="closeView('music-view')">‚Üê Kembali</button><h2 class="view-title">üéµ Musik Fokus</h2><div class="grid" id="music-grid"></div></div>
    
    <div class="fullscreen-view" id="quiz-view">
        <button class="back-button" onclick="closeView('quiz-view')">‚Üê Kembali</button>
        <h2 class="view-title">üß© Tebak-Tebakan Santai</h2>
        <div class="container" style="margin:0 auto">
            <p style="font-size:1.5em;margin-bottom:30px">Lelah belajar? Yuk refresh otak sejenak dengan tebak-tebakan seru!</p>
            <button class="start-button" style="font-size:1.2em;padding:15px 40px" onclick="startRiddles()">üöÄ Mulai Main</button>
        </div>
    </div>
    
    <div class="fullscreen-view" id="stats-view">
        <button class="back-button" onclick="closeView('stats-view')">‚Üê Kembali</button>
        <h2 class="view-title">üìä Statistik Belajar</h2>
        <div class="container" style="max-width:800px;margin:0 auto">
            <h3 style="color:var(--c-theme);font-size:2em;margin-bottom:20px">Progress Harian</h3>
            <div class="daily-progress-circle">
                <div class="daily-progress-text" id="daily-progress-percent">0%</div>
                <svg width="200" height="200"><circle class="progress-ring__circle progress-ring__bg" stroke-width="15" fill="transparent" r="92.5" cx="100" cy="100"/><circle class="progress-ring__circle progress-ring__active" id="daily-progress-ring" stroke-width="15" fill="transparent" r="92.5" cx="100" cy="100" style="transform:rotate(-90deg);transform-origin:center"/></svg>
            </div>
            <div style="margin:20px 0;font-weight:700;color:var(--c-theme)">Target Harian (Menit): <input type="number" id="daily-target-input" value="100"></div>
            <div class="stats-grid">
                <div class="stat-item"><div class="stat-item-value" id="stats-pomodoro-count">0 Menit</div><div class="stat-item-label">‚è±Ô∏è Rata-Rata Fokus/Hari (7 Hari)</div></div>
                <div class="stat-item"><div class="stat-item-value" id="stats-study-minutes">0</div><div class="stat-item-label">üìö Total Menit Hari Ini</div></div>
            </div>
        </div>
    </div>
    
    <div class="quiz-modal" id="quiz-modal">
        <div class="quiz-content">
            <div class="quiz-header"><div id="quiz-progress">Soal 1/5</div><div id="quiz-score">Skor: 0</div></div>
            <div id="quiz-container"></div>
        </div>
    </div>

    <audio id="alarm-sound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_c610232532.mp3"></audio> 
    <audio id="focus-audio" loop></audio>

    <script>
        const T={focus:25,shortBreak:5,longBreak:15};
        const Q=["Tekad hari ini menentukan kesuksesan hari esok.","One small step is still progress.","Focus on the process, not perfection.","Today is a good day to learn.","Discipline is the bridge between goals and accomplishment.","The secret of getting ahead is getting started.","Consistency is key.","Lakukan yang terbaik. Tuhan yang akan menentukan hasilnya."];
        const TH={
            Forest:{n:'üå≥ Forest',d:'Suasana hutan tenang',p:'#84a98c',t:'#526655',a:'forest.mp3',e:['üå≤','ü¶ã','üçÉ','üåø','ü¶â','üêøÔ∏è','üå≥','üçÇ'],c:['#a8dadc','#457b9d','#1d3557']},
            Coffee:{n:'‚òï Coffee',d:'Hangat kedai kopi',p:'#A17A61',t:'#6D4C41',a:'coffee_shop.mp3',e:['‚òï','üìñ','üç∞','ü•ê','‚òÅÔ∏è','üí≠','üç™','ü•§'],c:['#ECE0C8','#CDBCA1','#6D4C41']},
            NightCity:{n:'üåÉ Night',d:'Malam kota hidup',p:'#80CBC4',t:'#34495e',a:'night_sound.mp3',e:['üåÉ','üåô','‚≠ê','üèôÔ∏è','‚ú®','üå†','üåÜ','üí´'],c:['#1A2930','#0C1C29','#000814']},
            Calm:{n:'‚òÅÔ∏è Calm',d:'Ruangan tenang',p:'#79A0C3',t:'#4a6078',a:'piano.mp3',e:['‚òÅÔ∏è','üïäÔ∏è','üíô','ü¶¢','üåä','üéê','üå¨Ô∏è','üí®'],c:['#D8E2DC','#B5C7D8','#90AFC5']},
            Rain:{n:'üåßÔ∏è Rain',d:'Suara hujan',p:'#5B8FB9',t:'#2C3E50',a:'rain_sound.mp3',e:['üåßÔ∏è','‚òî','üíß','‚õàÔ∏è','üåÇ','üí¶','‚òÅÔ∏è','üå¶Ô∏è'],c:['#778DA9','#415A77','#1B263B']}
        };
        const RIDDLES=[
            {q:"Aku punya kota, tapi tidak ada rumah. Aku punya gunung, tapi tidak ada pohon. Aku punya air, tapi tidak ada ikan. Apa aku?",o:["Peta","Globe","Lukisan","Mimpi"],c:0,e:"Peta menggambarkan semua itu tanpa bentuk fisik nyata."},
            {q:"Apa yang naik tapi tidak pernah turun?",o:["Umur","Gaji","Balon","Pesawat"],c:0,e:"Umur kita selalu bertambah dan tak bisa kembali."},
            {q:"Apa yang punya banyak kunci tapi tidak bisa membuka satu pintu pun?",o:["Piano","Gudang","Tukang Kunci","Brankas"],c:0,e:"Piano memiliki tuts yang disebut 'keys' (kunci)."},
            {q:"Makin diisi makin ringan. Benda apakah itu?",o:["Balon","Kapas","Ember","Tas"],c:0,e:"Balon yang diisi gas helium akan melayang ringan."},
            {q:"Aku punya gigi tapi tidak bisa menggigit. Siapakah aku?",o:["Sisir","Gergaji","Resleting","Hiu"],c:0,e:"Sisir punya 'gigi' untuk merapikan rambut."},
            {q:"Selalu di pojok tapi bisa keliling dunia?",o:["Perangko","Pojok Ruangan","Kucing","Bayangan"],c:0,e:"Perangko ditempel di pojok amplop surat."},
            {q:"Jika disebut, aku malah pecah/hilang. Siapakah aku?",o:["Kesunyian","Janji","Kaca","Gelembung"],c:0,e:"Saat kamu berkata 'sunyi', kesunyian itu hilang."},
            {q:"Punya leher tapi tak punya kepala?",o:["Baju","Botol","Jerapah","Gitar"],c:0,e:"Baju punya kerah/leher tapi tidak punya kepala sendiri."}
        ];
        
        let s={th:'Forest',mo:'focus',t:T.focus*60,it:T.focus*60,run:!1,ti:null,qi:null,ca:null,lastRecordedMin:T.focus,cq:null,cs:0,st:{d:new Date().toDateString(),pc:0,sm:0,dt:100},weeklyData:[]};
        
        document.addEventListener('DOMContentLoaded',()=>{lS();ev();iT();iM();uT();aT(s.mo);bg()});
        
        function ev(){
            document.getElementById('start-focus-btn').onclick=()=>{
                document.getElementById('splash-screen').classList.add('hidden');
                document.getElementById('home-button').style.display='flex';
                qC();
                s.qi=setInterval(qC,15000)
            };
            document.getElementById('dots-icon').onclick=(e)=>{e.stopPropagation();document.getElementById('menu-dropdown').classList.toggle('active')};
            document.onclick=(e)=>{if(!e.target.closest('.three-dots-menu'))document.getElementById('menu-dropdown').classList.remove('active')};
            document.querySelectorAll('.menu-option').forEach(o=>o.onclick=()=>{openView(o.dataset.view+'-view');document.getElementById('menu-dropdown').classList.remove('active')});
            document.getElementById('dark-mode-toggle').onclick=tD;
            document.getElementById('start-pause-btn').onclick=()=>{s.run?pT():sT()};
            document.getElementById('reset-btn').onclick=rT;
            document.querySelectorAll('.modes button').forEach(b=>b.onclick=(e)=>sM(e.target.id.replace('-btn','')));
            document.getElementById('daily-target-input').onchange=(e)=>{s.st.dt=parseInt(e.target.value)||100;svS();uS()};
        }
        
        function goToHome(){
            document.getElementById('splash-screen').classList.remove('hidden');
            document.getElementById('home-button').style.display='none';
            if(s.run)pT();
            clearInterval(s.qi);
        }
        
        function iT(){
            const g=document.getElementById('theme-grid');
            Object.entries(TH).forEach(([k,v])=>{
                const d=document.createElement('div');
                d.className='card'+(k===s.th?' active':'');
                d.innerHTML=`<div style="font-size:4em;margin-bottom:15px">${v.n.split(' ')[0]}</div><div style="font-size:1.5em;font-weight:700">${v.n}</div><div>${v.d}</div>`;
                d.onclick=()=>{s.th=k;document.querySelectorAll('#theme-grid .card').forEach(c=>c.classList.remove('active'));d.classList.add('active');aT(s.mo);bg()};
                g.appendChild(d)
            })
        }
        
        function iM(){
            const g=document.getElementById('music-grid');
            Object.entries(TH).forEach(([k,v])=>{
                const d=document.createElement('div');
                d.className='card';
                d.innerHTML=`<div class="music-header"><div style="font-size:1.3em;font-weight:700">${v.n}</div><div style="display:flex;gap:10px"><button class="music-btn" onclick="pA('${v.a}')">‚ñ∂Ô∏è</button><button class="music-btn" onclick="stopMusic()">‚è∏Ô∏è</button></div></div>`;
                g.appendChild(d)
            })
        }
        
        function pA(file){
            const a=document.getElementById('focus-audio');
            if(s.ca!==file){
                a.src=file;
                s.ca=file;
                a.load();
            }
            a.play().catch(err=>{
                console.warn("Gagal memutar audio:",err);
                document.getElementById('status-msg').textContent="‚ö†Ô∏è Gagal memutar musik. Pastikan file '"+file+"' ada di folder yang sama.";
            });
        }
        
        function stopMusic(){
            document.getElementById('focus-audio').pause();
        }
        
        function aT(m){
            const r=document.documentElement,d=document.body.classList.contains('dark-mode'),t=m==='focus'?TH[s.th]:{p:m==='shortBreak'?'#FF9A8D':'#D8BFD8',t:m==='shortBreak'?'#FF6F61':'#8A2BE2',c:m==='shortBreak'?['#FFF4E8','#FFCBA4','#FF9A8D']:['#F5F0FF','#E6E6FA','#D8BFD8']};
            r.style.setProperty('--c-theme',t.p);
            r.style.setProperty('--c-text',d?t.p:t.t);
            document.getElementById('background-overlay').style.background=`linear-gradient(135deg,${d?'#212121,#333,#424242':t.c.join(',')})`;
            uS()
        }
        
        function bg(){
            const c=document.getElementById('bg-elements'),e=TH[s.th].e;
            c.innerHTML='';
            for(let i=0;i<30;i++){
                const el=document.createElement('div');
                el.className='bg-el';
                el.textContent=e[Math.floor(Math.random()*e.length)];
                el.style.left=(i%6*16+Math.random()*10)+'%';
                el.style.top=(Math.floor(i/6)*20+Math.random()*15)+'%';
                el.style.animationDelay=Math.random()*5+'s';
                el.style.animationDuration=(10+Math.random()*10)+'s';
                c.appendChild(el)
            }
        }
        
        function startRiddles(){
            const q=[...RIDDLES].sort(()=>.5-Math.random()).slice(0,5);
            s.cq={q:q.map(x=>({...x,o:[...x.o].sort(()=>.5-Math.random())})),i:0,s:0};
            document.getElementById('quiz-modal').classList.add('active');
            dQ()
        }
        
        function dQ(){
            const q=s.cq.q[s.cq.i],c=document.getElementById('quiz-container');
            document.getElementById('quiz-progress').textContent=`Soal ${s.cq.i+1}/${s.cq.q.length}`;
            document.getElementById('quiz-score').textContent=`Skor: ${s.cq.s}`;
            c.innerHTML=`<div class="quiz-question">${q.q}</div>`+q.o.map((o,i)=>`<div class="quiz-option" onclick="chk(${i},'${o.replace(/'/g,"\\'")}')">${o}</div>`).join('')+`<div id="exp"></div>`
        }
        
        function chk(idx,txt){
            const q=s.cq.q[s.cq.i],ops=document.querySelectorAll('.quiz-option'),cor=q.o.indexOf(RIDDLES.find(r=>r.q===q.q).o[RIDDLES.find(r=>r.q===q.q).c]);
            ops.forEach(o=>o.classList.add('disabled'));
            const isC=txt===RIDDLES.find(r=>r.q===q.q).o[RIDDLES.find(r=>r.q===q.q).c];
            ops[idx].classList.add(isC?'correct':'incorrect');
            if(!isC)ops.forEach(o=>{if(o.textContent===RIDDLES.find(r=>r.q===q.q).o[RIDDLES.find(r=>r.q===q.q).c])o.classList.add('correct')});
            if(isC)s.cq.s+=20;
            document.getElementById('quiz-score').textContent=`Skor: ${s.cq.s}`;
            document.getElementById('exp').innerHTML=`<div class="quiz-explanation"><b>${isC?'‚úÖ Benar!':'‚ùå Salah'}</b><br>${q.e}</div><div style="text-align:center"><button class="quiz-nav-btn" onclick="nQ()">${s.cq.i<4?'Lanjut ‚Üí':'Selesai'}</button></div>`
        }
        
        function nQ(){s.cq.i++;if(s.cq.i>=5)endQ();else dQ()}
        
        function endQ(){
            document.getElementById('quiz-container').innerHTML=`<div style="text-align:center;padding:40px"><div style="font-size:5em">üéâ</div><div style="font-size:2em;font-weight:900;color:var(--c-theme)">Skor Akhir: ${s.cq.s}</div><p>Otak sudah fresh lagi? Yuk lanjut belajar!</p><button class="quiz-nav-btn" onclick="document.getElementById('quiz-modal').classList.remove('active')">Tutup</button></div>`;
            svS();uS()
        }
        
        function sT(){
            if(s.run)return;
            s.run=!0;
            document.getElementById('start-pause-btn').textContent='‚è∏Ô∏è Jeda';
            s.lastRecordedMin=Math.ceil(s.t/60);
            s.ti=setInterval(()=>{
                s.t--;
                uT();
                if(s.mo==='focus'){
                    const currentMin=Math.ceil(s.t/60);
                    if(currentMin<s.lastRecordedMin){
                        s.st.sm++;
                        s.lastRecordedMin=currentMin;
                        svS();uS()
                    }
                }
                if(s.t<=0)endT()
            },1e3)
        }
        
        function pT(){
            clearInterval(s.ti);
            s.run=!1;
            document.getElementById('start-pause-btn').textContent='‚ñ∂Ô∏è Lanjut'
        }
        
        function rT(){
            pT();
            if(s.mo==='focus'&&s.t===0)s.st.pc++;
            s.t=T[s.mo]*60;
            s.it=s.t;
            s.lastRecordedMin=T[s.mo];
            uT();svS();uS()
        }
        
        function endT(){
            pT();
            document.getElementById('alarm-sound').play();
            if(s.mo==='focus'){s.st.pc++;svS();uS();sM('shortBreak')}else sM('focus');
            sT()
        }
        
        function sM(m){
            s.mo=m;
            s.t=T[m]*60;
            s.it=s.t;
            s.lastRecordedMin=T[m];
            document.querySelectorAll('.modes button').forEach(b=>b.classList.remove('active'));
            document.getElementById(m+'-btn').classList.add('active');
            uT();aT(m);
            document.getElementById('status-msg').textContent=m==='focus'?'Waktunya fokus! ‚ú®':'Waktunya istirahat üçÉ'
        }
        
        function uT(){
            const m=Math.floor(s.t/60),sc=s.t%60;
            document.getElementById('minutes').textContent=String(m).padStart(2,'0');
            document.getElementById('seconds').textContent=String(sc).padStart(2,'0');
            const p=1-(s.t/s.it),c=document.querySelector('.progress-ring__active'),o=967.6-(p*967.6);
            c.style.strokeDasharray='967.6';
            c.style.strokeDashoffset=o
        }
        
        function lS(){
            const d=localStorage.getItem('pomodoroStats'),w=localStorage.getItem('weeklyData');
            if(w)s.weeklyData=JSON.parse(w);
            if(d){
                const p=JSON.parse(d);
                if(p.d===new Date().toDateString()){s.st.d=p.d;s.st.pc=p.pc||0;s.st.sm=p.sm||0;s.st.dt=p.dt||100}
                else{s.st.d=new Date().toDateString();s.st.dt=p.dt||100;s.st.pc=0;s.st.sm=0;svS()}
            }
            uS()
        }
        
        function svS(){
            localStorage.setItem('pomodoroStats',JSON.stringify(s.st));
            const today=new Date().toDateString(),todayData={d:s.st.d,sm:s.st.sm,pc:s.st.pc},existingIndex=s.weeklyData.findIndex(item=>item.d===today);
            if(existingIndex!==-1)s.weeklyData[existingIndex]=todayData;else s.weeklyData.push(todayData);
            s.weeklyData=s.weeklyData.filter(item=>{
                const itemDate=new Date(item.d),sevenDaysAgo=new Date();
                sevenDaysAgo.setDate(sevenDaysAgo.getDate()-7);
                return itemDate.setHours(0,0,0,0)>=sevenDaysAgo.setHours(0,0,0,0)
            });
            localStorage.setItem('weeklyData',JSON.stringify(s.weeklyData))
        }
        
        function uS(){
            document.getElementById('stats-study-minutes').textContent=s.st.sm;
            document.getElementById('daily-target-input').value=s.st.dt;
            const totalMinutesLast7Days=s.weeklyData.reduce((sum,item)=>sum+item.sm,0),daysCount=s.weeklyData.length>0?s.weeklyData.length:1,avgMinutesPerDay=(totalMinutesLast7Days/daysCount).toFixed(0);
            document.getElementById('stats-pomodoro-count').textContent=avgMinutesPerDay+' Menit';
            const p=Math.min(s.st.sm/s.st.dt,1),c=document.getElementById('daily-progress-ring'),o=581-(p*581);
            document.getElementById('daily-progress-percent').textContent=Math.round(p*100)+'%';
            c.style.strokeDasharray='581';
            c.style.strokeDashoffset=o;
            c.style.stroke=p>=1?'#2ecc71':'var(--c-theme)'
        }
        
        function qC(){
            const d=document.getElementById('quote-display');
            d.style.opacity=0;
            setTimeout(()=>{d.textContent=`"${Q[Math.floor(Math.random()*Q.length)]}"`;d.style.opacity=1},300)
        }
        
        function openView(v){document.getElementById('main-view').style.display='none';document.getElementById(v).classList.add('active')}
        function closeView(v){document.getElementById(v).classList.remove('active');document.getElementById('main-view').style.display='flex'}
        
        function tD(){
            document.body.classList.toggle('dark-mode');
            document.getElementById('dark-mode-toggle').classList.toggle('active');
            const d=document.body.classList.contains('dark-mode');
            document.getElementById('mode-label').textContent=d?'Dark Mode':'Light Mode';
            localStorage.setItem('darkMode',d);
            aT(s.mo)
        }
        
        if(localStorage.getItem('darkMode')==='true')tD();
    </script>
</body>
</html>